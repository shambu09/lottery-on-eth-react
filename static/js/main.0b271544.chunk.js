(this["webpackJsonplottery-on-eth-react"]=this["webpackJsonplottery-on-eth-react"]||[]).push([[0],{217:function(e,t,n){},219:function(e,t,n){},233:function(e,t){},235:function(e,t){},239:function(e,t){},240:function(e,t){},267:function(e,t){},269:function(e,t){},279:function(e,t){},281:function(e,t){},291:function(e,t){},293:function(e,t){},309:function(e,t){},343:function(e,t){},344:function(e,t){},414:function(e,t){},416:function(e,t){},421:function(e,t){},423:function(e,t){},430:function(e,t){},442:function(e,t){},445:function(e,t){},450:function(e,t){},523:function(e,t,n){"use strict";n.r(t);var a=n(32),c=n.n(a),r=n(207),o=n.n(r),s=(n(217),n(13)),u=n.n(s),i=n(16),l=n(53),b=n(210),d=(n(219),n(54)),p=n.n(d),h=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,n=null,a=null,c=null,e.prev=4,e.next=7,window.ethereum.request({method:"eth_requestAccounts"});case 7:c=e.sent,a=new p.a(window.ethereum),t=!0,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),n=e.t0;case 15:return e.abrupt("return",{accounts:c,web3:a,enabled:t,error:n});case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(){return e.apply(this,arguments)}}(),f=[{constant:!1,inputs:[],name:"Enter",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[],name:"manager",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"pickWinner",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"getPlayers",outputs:[{name:"",type:"address[]"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"players",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"}],j=function(e){return new e.eth.Contract(f,"0xc1fe31c3c9772cf7f1cc7e24e280d1b9e27f1950")},m=n(9);var y=function(){var e=Object(a.useState)({isEnabled:!1,web3Con:null,lottery:null,manager:null,account:null,balance:"",players:[],value:"",message:""}),t=Object(b.a)(e,2),n=t[0],c=t[1];Object(a.useEffect)((function(){var e=function(e){console.log("Accounts Changed"),window.location.reload()},t=function(e){console.log("Chain Changed"),window.location.reload()},n=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var a,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.methods.manager().call();case 2:return a=e.sent,e.next=5,n.eth.getBalance(t.options.address);case 5:return r=e.sent,e.next=8,t.methods.getPlayers().call();case 8:o=e.sent,c((function(e){return Object(i.a)(Object(i.a)({},e),{},{manager:a,balance:r,players:o})}));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return h().then((function(a){var r=a.accounts,o=a.web3,s=a.enabled,u=a.error;s?(console.log("Connected to Metamask"),function(e,t){window.ethereum.on("accountsChanged",e),window.ethereum.on("chainChanged",t)}(e,t),c((function(e){var t=j(o);return n(t,o),Object(i.a)(Object(i.a)({},e),{},{isEnabled:s,web3Con:o,lottery:t,account:r[0]})}))):(console.log("Error connecting to Metamask, Traceback: "),console.log(u))})),function(){try{!function(e,t){window.ethereum.removeListener("accountsChanged",e),window.ethereum.removeListener("chainChanged",t)}(e,t)}catch(n){console.log("Unable To Remove Listeners or No Listners at all, TraceBack: "),console.log(n)}}}),[]);var r=function(){var e=Object(l.a)(u.a.mark((function e(t){var a,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=n.account,c((function(e){return Object(i.a)(Object(i.a)({},e),{},{message:"Waiting on transaction success..."})})),e.prev=3,e.next=6,n.lottery.methods.Enter().send({from:a,value:p.a.utils.toWei(n.value,"ether")});case 6:return e.next=8,n.web3Con.eth.getBalance(n.lottery.options.address);case 8:return r=e.sent,e.next=11,n.lottery.methods.getPlayers().call();case 11:o=e.sent,c((function(e){return Object(i.a)(Object(i.a)({},e),{},{players:o,message:"You have been entered!",balance:r})})),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),console.log("Error: "),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(l.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=n.account,c((function(e){return Object(i.a)(Object(i.a)({},e),{},{message:"Waiting on transaction success..."})})),e.prev=3,e.next=6,n.lottery.methods.pickWinner().send({from:a});case 6:c((function(e){return Object(i.a)(Object(i.a)({},e),{},{message:"A winner has been picked!"})})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),console.log("Error: "),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsxs)("div",{className:"Account-info",children:[Object(m.jsxs)("div",{children:["Account :"," ",n.account?n.account:"Not Initialized"]}),Object(m.jsx)("div",{children:n.isEnabled?"Connected to Metamask":"Not Connected to Metamask"})]}),Object(m.jsxs)("div",{className:"Contract",children:[Object(m.jsx)("h2",{children:"Lottery Contract"}),Object(m.jsxs)("div",{className:"Contract-details",children:[Object(m.jsxs)("p",{children:["This contract is managed by"," ",n.manager?n.manager:"No Manager"]}),Object(m.jsxs)("p",{children:["There are currently ",n.players.length," people entered, competing to win"," ",p.a.utils.fromWei(n.balance,"ether")," ether !"]}),Object(m.jsx)("hr",{}),Object(m.jsxs)("form",{onSubmit:r,children:[Object(m.jsx)("h3",{children:"Want to try your luck?"}),Object(m.jsxs)("div",{className:"input",children:[Object(m.jsx)("label",{children:"Amount of ether to enter : "}),Object(m.jsx)("input",{value:n.value,onChange:function(e){return c((function(t){return Object(i.a)(Object(i.a)({},t),{},{value:e.target.value})}))}})]}),Object(m.jsx)("button",{className:"btn",children:"Enter"})]}),n.manager&&n.account&&n.manager.toLowerCase()===n.account.toLowerCase()?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("hr",{}),Object(m.jsxs)("div",{children:[Object(m.jsx)("h4",{children:"Time to pick a winner?"}),Object(m.jsx)("button",{onClick:o,children:"Pick Winner"})]}),Object(m.jsx)("hr",{})]}):Object(m.jsx)("hr",{}),Object(m.jsx)("h1",{children:n.message})]})]})]})};o.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(y,{})}),document.getElementById("root"))}},[[523,1,2]]]);
//# sourceMappingURL=main.0b271544.chunk.js.map